## 20-strike backend service

### Запуск

Запускается на Windows с правами администратора для опрашиваемых компьютеров (обычно — администратора домена). Приложение умеет регистрировать себя в качестве службы и в urlacl при использовании http.sys (см "Ключи").

### Состав

В файле `prefixes` хранится адрес для HttpListener.

В файле `classes` хранится список классов WMI, для которых собираются данные, а также мета-классы, которые обрабатываются по особенным правилам.

База данных хранится в файле по имени `data.db` с предопределённой структурой.

Все эти дополнительные файлы (*в репозитории в каталоге `/data`*) должны находиться в каталоге с исполняемым файлом на момент запуска.

### Ключи

Приложение принимает аргументы командной строки.

**start** — попытка запуска приложения в нормальном режиме работы для сбора данных и прослушивания http запросов.

**register** — попытка зарегистрироваться в качестве службы при помощи вызова `sc` и добавления префикса в urlacl при помощи `netsh`. Префикс в данный момент зашит в коде на `+:80`. Требуется запускать с повышением прав. После регистрации службу необходимо запустить вручную, а также указать реквизиты пользователя для её входа.

**unregister** — удаление службы, не затрагивает urlacl. Требуется запускать с повышением прав.

**help** — показывает справку по аргументам и завершает работу. То же происходит при запуске без аргументов или с неверными аргументами.